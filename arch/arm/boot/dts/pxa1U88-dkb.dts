/*
 *  Copyright (C) 2012 Marvell Technology Group Ltd.
 *  Author: Haojian Zhuang <haojian.zhuang@marvell.com>
 *
 *  This program is free software; you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License version 2 as
 *  publishhed by the Free Software Foundation.
 */

/dts-v1/;
#include "pxa1U88.dtsi"
#include "pxa988-pinfunc.h"

/ {
	model = "Marvell PXA1U88 DKB Development Board";
	compatible = "marvell,pxa1U88-dkb", "marvell,pxa1U88";

	chosen {
		bootargs = "console=ttyS0,115200 root=/dev/nfs nfsroot=192.168.1.100:/nfsroot/ ip=192.168.1.101:192.168.1.100::255.255.255.0::eth0:on";
	};

	memory {
		reg = <0x00000000 0x10000000>;
	};

	soc {
		axi@d4200000 {	/* AXI */
			intc: wakeupgen@d4282000 {
				status = "okay";
			};
		};

		apb@d4000000 {
			timer0: timer@d4014000 {
				status = "disabled";
			};

			timer1: timer@d4016000 {
				status = "disabled";
			};

			keypad: keypad@d4012000 {
				marvell,direct-keys;
				marvell,direct-key-low-active;
				marvell,keypad-lpm-mod;
				marvell,direct-key-count = <2>;
				marvell,direct-key-mask = <0xff>;
				marvell,direct-key-map = < 0x73
							   0x72>;
				marvell,debounce-interval = <30>;
				pinctrl-names = "default";
				pinctrl-0 = <&keypad_in_func>;
			};

			pmx: pinmux@d401e000 {
				/* pin base, nr pins & gpio function */
				pinctrl-single,gpio-range = <
					/*
					 * GPIO number is hardcoded for range at here.
					 * In gpio chip, GPIO number is not hardcoded for range.
					 * Since one gpio pin may be routed to multiple pins,
					 * define these gpio range in pxa910-dkb.dts not pxa910.dtsi.
					 */
					&range 55 55 0	/* GPIO0 ~ GPIO54 */
					&range 110 32 0 /* GPIO67 ~ GPIO98 */
					&range 52 1 0	/* GPIO124 */
				>;

				keypad_in_func: keypad_in_func {
					pinctrl-single,pins = <
						GPIO16 AF1	/* GPIO016_KP_DKIN1 */
						GPIO17 AF1	/* GPIO017_KP_DKIN2 */
					>;
					DS_MEDIUM;PULL_UP;EDGE_NONE;LPM_DRIVE_HIGH;
				};
				twsi0_pmx_func: twsi0_pmx_func {
					/* gpio79/80: AF1 */
					pinctrl-single,pins = <
						GPIO79 0x1
						GPIO80 0x1
					>;
					MFP_LPM_FLOAT;
				};
				twsi0_pmx_gpio: twsi0_pmx_gpio {
					pinctrl-single,pins = <
						GPIO79 AF0
						GPIO80 AF0
					>;
					MFP_LPM_FLOAT;
				};
				twsi1_pmx_func: twsi1_pmx_func {
					/* gpio87/88: AF5 */
					pinctrl-single,pins = <
						GPIO87 0x5
						GPIO88 0x5
					>;
					MFP_LPM_FLOAT;
				};
				twsi1_pmx_gpio: twsi1_pmx_gpio {
					pinctrl-single,pins = <
						GPIO87 AF0
						GPIO88 AF0
					>;
					MFP_LPM_FLOAT;
				};
				twsi3_pmx_func: twsi3_pmx_func {
					/* gpio73/74: AF5 */
					pinctrl-single,pins = <
						0x1d0 0x5
						0x1d4 0x5
					>;
					MFP_LPM_FLOAT;
				};
				twsi3_pmx_gpio: twsi3_pmx_gpio {
					pinctrl-single,pins = <
						GPIO73 AF0
						GPIO74 AF0
					>;
					MFP_LPM_FLOAT;
				};
				twsi3_pmx_senhb: twsi3_pmx_senhb {
					pinctrl-single,pins = <
						GPIO73 AF7
						GPIO74 AF7
					>;
					MFP_DEFAULT;
				};
				twsi3_pmx_senhb_def: twsi3_pmx_senhb_def {
					pinctrl-single,pins = <
						GPIO73 AF7
						GPIO74 AF7
					>;
					MFP_LPM_FLOAT;
				};
				dvc_pmx_func: dvc_pmx_func {
					pinctrl-single,pins = <
						GPIO93 AF5
						GPIO94 AF5
					>;
					MFP_DEFAULT;
				};
				pm830_pmx_func1: pm830_pmx_func1 {
					pinctrl-single,pins = <
						GPIO29 AF0
					>;
					MFP_DEFAULT;
				};
				pm830_pmx_func1_sleep: pm830_pmx_func1_sleep {
					pinctrl-single,pins = <
						GPIO29 AF0
					>;
					DS_MEDIUM;PULL_NONE;EDGE_BOTH;LPM_NONE;
				};
				pm830_pmx_leds: pm830_pmx_leds {
					pinctrl-single,pins = <
						GPIO19 AF0	/* PA_EN */
						GPIO95 AF0	/* FLASH_EN */
					>;
					MFP_LPM_FLOAT;
				};
				pm830_bat_det: pm830_bat_det {
					pinctrl-single,pins = <
						GPIO31 AF0	/* BAT_DET */
					>;
					MFP_LPM_PULL_DW;
				};
			};
			twsi0: i2c@d4011000 {
				pinctrl-names = "default","gpio";
				pinctrl-0 = <&twsi0_pmx_func>;
				pinctrl-1 = <&twsi0_pmx_gpio>;
				i2c-gpio = <&gpio 79 0 &gpio 80 0>;
				status = "okay";
			};
			twsi1: i2c@d4010800 {
				pinctrl-names = "default","gpio";
				pinctrl-0 = <&twsi1_pmx_func>;
				pinctrl-1 = <&twsi1_pmx_gpio>;
				i2c-gpio = <&gpio 87 0 &gpio 88 0>;
				status = "okay";
			};
			twsi2: i2c@d4037000 {
				status = "okay";

				pmic0: 88pm822@30 {
					reg = <0x30>;
					interrupts = <0 4 IRQ_TYPE_LEVEL_HIGH>;
					interrupt-parent = <&gic>;
					/* TODO: move this part out */
					dvc {
						pinctrl-names = "default";
						pinctrl-0 = <&dvc_pmx_func>;
					};
				};

				pmic1: 88pm830@68 {
					pinctrl-names = "default", "sleep";
					pinctrl-0 = <&pm830_pmx_func1 &pm830_pmx_leds &pm830_bat_det>;
					pinctrl-1 = <&pm830_pmx_func1_sleep &pm830_pmx_leds &pm830_bat_det>;
					edge-wakeup-gpio = <29>; /* GPIO29: interrupt line */

					reg = <0x68>;
					interrupt-parent = <&gpio>;
					interrupts = <29 IRQ_TYPE_EDGE_FALLING>;

				        charger {
					        status = "okay";
				        };
				        battery {
					        /* board design related */
					        external-resistor = <200>; /* mohm */
					        /* using scenario */
					        power-off-threshold = <3350>; /* mV */
					        safe-power-off-threshold = <3000>; /* mV */
					        status = "okay";
				        };
				        led {
					        flash-en-gpio = <95>;
					        flash-txmsk-gpio = <19>;
					        status = "okay";
				        };
					vbus {
						gpadc-number = <1>;
						status = "okay";
					};

				        debug {
					       status = "okay";
				        };
			       };
			};
			twsi3: i2c@d4013800 {
				pinctrl-names = "default", "gpio";
				pinctrl-0 = <&twsi3_pmx_func>;
				pinctrl-1 = <&twsi3_pmx_gpio>;
				i2c-gpio = <&gpio 73 0 &gpio 74 0>;
				status = "okay";
			};
		};
	};

	ion {
		marvell,ion-nr = <2>;
		status = "okay";
		marvell,ion-iommu = <1>;
		heap1 {
			marvell,ion-name = "carveout_heap";
			marvell,ion-type = <2>;
			marvell,ion-id = <2>;
			marvell,ion-base = <0>;
			marvell,ion-size = <0>;
		};
		heap2 {
			marvell,ion-name = "system_heap";
			marvell,ion-type = <0>;
			marvell,ion-id = <0>;
		};
	};
};
#include "88pm822.dtsi"
#include "88pm822_pxa1u88_dkb.dtsi"

#include "88pm830.dtsi"
#include "88pm830_battery_common.dtsi"
#include "88pm830_sp4555557sa.dtsi"
